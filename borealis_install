#!bin/bash

ip="192.168.2.23"

while getopts ip:help flag
do
    case "${flag}" in
        ip) ip=${OPTARG};;
        help) echo "Usage: $0 [-f ip - Will set the static ip] [-reinstall - Will redownload lib-camera]"
           exit 1;;
    esac
done

command5_output=$(git clone https://github.com/25nlambert/BOREALIS_Cam.git)
echo "$command5_output"

sudo cp BOREALIS_Cam/config.txt /boot/config.txt

sudo cp BOREALIS_Cam/dhcpcd.conf /etc/dhcpcd.conf

sudo cp BOREALIS_Cam/.bashrc /home/pi/.bashrc

sudo cp BOREALIS_Cam/BOREALIS_CAM.service /etc/systemd/system

sudo chmod +x /home/pi/BOREALIS_Cam/start_stream
sudo chmod +x /home/pi/BOREALIS_Cam/edit_stream

sudo systemctl enable ssh #Enable SSH
sudo systemctl start ssh

sudo systemctl stop cups.service cups-browsed.service bluetooth.service hciuart.service #turn off unnecessary services
sudo systemctl disable cups.service cups-browsed.service bluetooth.service hciuart.service
sudo systemctl mask bluetooth.service hciuart.service

sudo apt purge avahi-daemon pipewire pipwire-bin modemmanager packagekit libnss-mdns #deleting unnecessary processes

sudo systemctl enable BOREALIS_CAM.service

sudo reboot
